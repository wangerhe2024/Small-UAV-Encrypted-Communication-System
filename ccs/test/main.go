package main

import (
	"crypto/cipher"
	"encoding/hex"
	"fmt"
	"log"
	"os"
	"strconv"
	"time"

	// "crypto/aes"

	"github.com/emmansun/gmsm/sm4"
)

var LongData string = "e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f941759e6ee867a51dc33824edd269e893e974e9b7064100437375e9d74119fe6ca65a4d0b1dd7e189038bc5b64ca2b7f3efbfb17e6cc9d3851423c2dc7fb4d3b547e17e1494c3fdfb7b7cf56fc25cd4d832cf8670113723e777fa7a7e73ae619c244c534dab3250ffaf6dfdd8f821c98f6d85702ccea2ba38b6d5bcfb66f7821852156e2db977012c60e2fb4c941bbdb8380c02a933c6542fa7db351aa6978982abbbbb5b9217a750ee3939afe9dbf73fda8670b23c14fd1fdf5b1e08812f2d199bcfaf843970d66d7f63d45dcace60f6364624ebd6beac7f14493a3e6080625ce3f19b126fab7879f55edeebe593ab73043cd8b76794bc10d57efaf7d7a4e6d6bead1fcdbdf0c3043496af635c350893e1650c22e13f65f2f6fc17513bd8ada6f6d6bad7a5af15ca972c538cc2635c6917be5b4b4512ca70803eaddfc30ade911be13beee96ab8853b39f5ddebf36eb7d4c9867333d93ffd3f6234bc27d2241eff45171fb51cdf51a53af5c5e3373bb82ed6bba248bb09754add6197045b26cd76acffb6d855908a765f6e9e6ff041855c7835dd7fb3fcf8e0402862a5ef6ae57572bab636518095d8bcab16c6a8d8f829561eb965dfb211557ead8ace368538dc07a456c6e7182f85b017f6273cbfd3ed5e2910748e29d62115965af6185092db3a56fcf54fa6d85b1c13db5b7ffa258bca41fb3ab7ea917821ad6c7d58beb589fc1f5f2d57e1356b0a3fffcffcea7feb17bb9ebd895747febd2097c46099f1c5e086e5cbe58ecc78893f56260a92618dfff6adbc2d8f092e9d12122f456e4ec977c46804cee32bebec628ec954295838d24a180be14506665eec27fb35fd5ebabd7fabd72cd8cb5cb55ac2b8439b55fe9b2c9ff56c4e7a33e18405fe52aefde2361c4aa00a16a322c62fa9178b777abab623208fabf85c1172e5b0c28e0c5f6bfaaddfd92acb84f0a4f2f7f9fb621fe9a3e1efabfd12bc2eb58c51bff57456c34a777fa6fe9db8e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f941759e6ee867a51dc33824edd269e893e974e9b7064100437375e9d74119fe6ca65a4d0b1dd7e189038bc5b64ca2b7f3efbfb17e6cc9d3851423c2dc7fb4d3b547e17e1494c3fdfb7b7cf56fc25cd4d832cf8670113723e777fa7a7e73ae619c244c534dab3250ffaf6dfdd8f821c98f6d85702ccea2ba38b6d5bcfb66f7821852156e2db977012c60e2fb4c941bbdb8380c02a933c6542fa7db351aa6978982abbbbb5b9217a750ee3939afe9dbf73fda8670b23c14fd1fdf5b1e08812f2d199bcfaf843970d66d7f63d45dcace60f6364624ebd6beac7f14493a3e6080625ce3f19b126fab7879f55edeebe593ab73043cd8b76794bc10d57efaf7d7a4e6d6bead1fcdbdf0c3043496af635c350893e1650c22e13f65f2f6fc17513bd8ada6f6d6bad7a5af15ca972c538cc2635c6917be5b4b4512ca70803eaddfc30ade911be13beee96ab8853b39f5ddebf36eb7d4c9867333d93ffd3f6234bc27d2241eff45171fb51cdf51a53af5c5e3373bb82ed6bba248bb09754add6197045b26cd76acffb6d855908a765f6e9e6ff041855c7835dd7fb3fcf8e0402862a5ef6ae57572bab636518095d8bcab16c6a8d8f829561eb965dfb211557ead8ace368538dc07a456c6e7182f85b017f6273cbfd3ed5e2910748e29d62115965af6185092db3a56fcf54fa6d85b1c13db5b7ffa258bca41fb3ab7ea917821ad6c7d58beb589fc1f5f2d57e1356b0a3fffcffcea7feb17bb9ebd895747febd2097c46099f1c5e086e5cbe58ecc78893f56260a92618dfff6adbc2d8f092e9d12122f456e4ec977c46804cee32bebec628ec954295838d24a180be14506665eec27fb35fd5ebabd7fabd72cd8cb5cb55ac2b8439b55fe9b2c9ff56c4e7a33e18405fe52aefde2361c4aa00a16a322c62fa9178b777abab623208fabf85c1172e5b0c28e0c5f6bfaaddfd92acb84f0a4f2f7f9fb621fe9a3e1efabfd12bc2eb58c51bff57456c34a777fa6fe9db8e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f941759e6ee867a51dc33824edd269e893e974e9b7064100437375e9d74119fe6ca65a4d0b1dd7e189038bc5b64ca2b7f3efbfb17e6cc9d3851423c2dc7fb4d3b547e17e1494c3fdfb7b7cf56fc25cd4d832cf8670113723e777fa7a7e73ae619c244c534dab3250ffaf6dfdd8f821c98f6d85702ccea2ba38b6d5bcfb66f7821852156e2db977012c60e2fb4c941bbdb8380c02a933c6542fa7db351aa6978982abbbbb5b9217a750ee3939afe9dbf73fda8670b23c14fd1fdf5b1e08812f2d199bcfaf843970d66d7f63d45dcace60f6364624ebd6beac7f14493a3e6080625ce3f19b126fab7879f55edeebe593ab73043cd8b76794bc10d57efaf7d7a4e6d6bead1fcdbdf0c3043496af635c350893e1650c22e13f65f2f6fc17513bd8ada6f6d6bad7a5af15ca972c538cc2635c6917be5b4b4512ca70803eaddfc30ade911be13beee96ab8853b39f5ddebf36eb7d4c9867333d93ffd3f6234bc27d2241eff45171fb51cdf51a53af5c5e3373bb82ed6bba248bb09754add6197045b26cd76acffb6d855908a765f6e9e6ff041855c7835dd7fb3fcf8e0402862a5ef6ae57572bab636518095d8bcab16c6a8d8f829561eb965dfb211557ead8ace368538dc07a456c6e7182f85b017f6273cbfd3ed5e2910748e29d62115965af6185092db3a56fcf54fa6d85b1c13db5b7ffa258bca41fb3ab7ea917821ad6c7d58beb589fc1f5f2d57e1356b0a3fffcffcea7feb17bb9ebd895747febd2097c46099f1c5e086e5cbe58ecc78893f56260a92618dfff6adbc2d8f092e9d12122f456e4ec977c46804cee32bebec628ec954295838d24a180be14506665eec27fb35fd5ebabd7fabd72cd8cb5cb55ac2b8439b55fe9b2c9ff56c4e7a33e18405fe52aefde2361c4aa00a16a322c62fa9178b777abab623208fabf85c1172e5b0c28e0c5f6bfaaddfd92acb84f0a4f2f7f9fb621fe9a3e1efabfd12bc2eb58c51bff57456c34a777fa6fe9db8e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f9417e974e9b7064100437375e9d74119e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f941759e6ee867a51dc33824edd269e893e974e9b7064100437375e9d74119fe6ca65a4d0b1dd7e189038bc5b64ca2b7f3efbfb17e6cc9d3851423c2dc7fb4d3b547e17e1494c3fdfb7b7cf56fc25cd4d832cf8670113723e777fa7a7e73ae619c244c534dab3250ffaf6dfdd8f821c98f6d85702ccea2ba38b6d5bcfb66f7821852156e2db977012c60e2fb4c941bbdb8380c02a933c6542fa7db351aa6978982abbbbb5b9217a750ee3939afe9dbf73fda8670b23c14fd1fdf5b1e08812f2d199bcfaf843970d66d7f63d45dcace60f6364624ebd6beac7f14493a3e6080625ce3f19b126fab7879f55edeebe593ab73043cd8b76794bc10d57efaf7d7a4e6d6bead1fcdbdf0c3043496af635c350893e1650c22e13f65f2f6fc17513bd8ada6f6d6bad7a5af15ca972c538cc2635c6917be5b4b4512ca70803eaddfc30ade911be13beee96ab8853b39f5ddebf36eb7d4c9867333d93ffd3f6234bc27d2241eff45171fb51cdf51a53af5c5e3373bb82ed6bba248bb09754add6197045b26cd76acffb6d855908a765f6e9e6ff041855c7835dd7fb3fcf8e0402862a5ef6ae57572bab636518095d8bcab16c6a8d8f829561eb965dfb211557ead8ace368538dc07a456c6e7182f85b017f6273cbfd3ed5e2910748e29d62115965af6185092db3a56fcf54fa6d85b1c13db5b7ffa258bca41fb3ab7ea917821ad6c7d58beb589fc1f5f2d57e1356b0a3fffcffcea7feb17bb9ebd895747febd2097c46099f1c5e086e5cbe58ecc78893f56260a92618dfff6adbc2d8f092e9d12122f456e4ec977c46804cee32bebec628ec954295838d24a180be14506665eec27fb35fd5ebabd7fabd72cd8cb5cb55ac2b8439b55fe9b2c9ff56c4e7a33e18405fe52aefde2361c4aa00a16a322c62fa9178b777abab623208fabf85c1172e5b0c28e0c5f6bfaaddfd92acb84f0a4f2f7f9fb621fe9a3e1efabfd12bc2eb58c51bff57456c34a777fa6fe9db8e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f941759e6ee867a51dc33824edd269e893e974e9b7064100437375e9d74119fe6ca65a4d0b1dd7e189038bc5b64ca2b7f3efbfb17e6cc9d3851423c2dc7fb4d3b547e17e1494c3fdfb7b7cf56fc25cd4d832cf8670113723e777fa7a7e73ae619c244c534dab3250ffaf6dfdd8f821c98f6d85702ccea2ba38b6d5bcfb66f7821852156e2db977012c60e2fb4c941bbdb8380c02a933c6542fa7db351aa6978982abbbbb5b9217a750ee3939afe9dbf73fda8670b23c14fd1fdf5b1e08812f2d199bcfaf843970d66d7f63d45dcace60f6364624ebd6beac7f14493a3e6080625ce3f19b126fab7879f55edeebe593ab73043cd8b76794bc10d57efaf7d7a4e6d6bead1fcdbdf0c3043496af635c350893e1650c22e13f65f2f6fc17513bd8ada6f6d6bad7a5af15ca972c538cc2635c6917be5b4b4512ca70803eaddfc30ade911be13beee96ab8853b39f5ddebf36eb7d4c9867333d93ffd3f6234bc27d2241eff45171fb51cdf51a53af5c5e3373bb82ed6bba248bb09754add6197045b26cd76acffb6d855908a765f6e9e6ff041855c7835dd7fb3fcf8e0402862a5ef6ae57572bab636518095d8bcab16c6a8d8f829561eb965dfb211557ead8ace368538dc07a456c6e7182f85b017f6273cbfd3ed5e2910748e29d62115965af6185092db3a56fcf54fa6d85b1c13db5b7ffa258bca41fb3ab7ea917821ad6c7d58beb589fc1f5f2d57e1356b0a3fffcffcea7feb17bb9ebd895747febd2097c46099f1c5e086e5cbe58ecc78893f56260a92618dfff6adbc2d8f092e9d12122f456e4ec977c46804cee32bebec628ec954295838d24a180be14506665eec27fb35fd5ebabd7fabd72cd8cb5cb55ac2b8439b55fe9b2c9ff56c4e7a33e18405fe52aefde2361c4aa00a16a322c62fa9178b777abab623208fabf85c1172e5b0c28e0c5f6bfaaddfd92acb84f0a4f2f7f9fb621fe9a3e1efabfd12bc2eb58c51bff57456c34a777fa6fe9db8e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f941759e6ee867a51dc33824edd269e893e974e9b7064100437375e9d74119fe6ca65a4d0b1dd7e189038bc5b64ca2b7f3efbfb17e6cc9d3851423c2dc7fb4d3b547e17e1494c3fdfb7b7cf56fc25cd4d832cf8670113723e777fa7a7e73ae619c244c534dab3250ffaf6dfdd8f821c98f6d85702ccea2ba38b6d5bcfb66f7821852156e2db977012c60e2fb4c941bbdb8380c02a933c6542fa7db351aa6978982abbbbb5b9217a750ee3939afe9dbf73fda8670b23c14fd1fdf5b1e08812f2d199bcfaf843970d66d7f63d45dcace60f6364624ebd6beac7f14493a3e6080625ce3f19b126fab7879f55edeebe593ab73043cd8b76794bc10d57efaf7d7a4e6d6bead1fcdbdf0c3043496af635c350893e1650c22e13f65f2f6fc17513bd8ada6f6d6bad7a5af15ca972c538cc2635c6917be5b4b4512ca70803eaddfc30ade911be13beee96ab8853b39f5ddebf36eb7d4c9867333d93ffd3f6234bc27d2241eff45171fb51cdf51a53af5c5e3373bb82ed6bba248bb09754add6197045b26cd76acffb6d855908a765f6e9e6ff041855c7835dd7fb3fcf8e0402862a5ef6ae57572bab636518095d8bcab16c6a8d8f829561eb965dfb211557ead8ace368538dc07a456c6e7182f85b017f6273cbfd3ed5e2910748e29d62115965af6185092db3a56fcf54fa6d85b1c13db5b7ffa258bca41fb3ab7ea917821ad6c7d58beb589fc1f5f2d57e1356b0a3fffcffcea7feb17bb9ebd895747febd2097c46099f1c5e086e5cbe58ecc78893f56260a92618dfff6adbc2d8f092e9d12122f456e4ec977c46804cee32bebec628ec954295838d24a180be14506665eec27fb35fd5ebabd7fabd72cd8cb5cb55ac2b8439b55fe9b2c9ff56c4e7a33e18405fe52aefde2361c4aa00a16a322c62fa9178b777abab623208fabf85c1172e5b0c28e0c5f6bfaaddfd92acb84f0a4f2f7f9fb621fe9a3e1efabfd12bc2eb58c51bff57456c34a777fa6fe9db8e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f9417e974e9b7064100437375e9d74119ee"

var VideoData = "e906282d2a437e00000182050000a6d496d67459eac85a19f16008004500057438012000401106f60a4001020a400101d980aa340580900280602e81707d9b47f462a8eb5c81000bf49b602afdd4a9e953a8731a747536fd34e7fe8c57ede19ccaf7a66d2aadf977b7b049b4bb7c13d557aab7556c6e4823b8dc20c16d0ede11763be19c604e7b963a6c5676d3b78211167e9dba5c1c08bb1ad8dcabfcae59767eadc24097bf3d533f0a755267d6d577477e2375b9e7fffd3ad7ca2eb212a77fff10ad7ae57cdbbfb5aee0879687f5f5b7d6b0ca82155a8c3d1ecf6dbeb48fcdad2f44ef4bd5a45af825d5eafd770474a5f4bd7fff82e9ee5d297e8ab0ce0874b0f3f4bf352b468af096db5236c1a5c28337376721a6c5d077267488cc5918e34166ef64e5a979fe585542661f70f5fe9a7e155024f23478cb4afffc3b08dec25aa692b92570ae17b43db6fcb91532a8492a64ddc16c6167e7ef39863049e6fbfeb4ca66bea54c3b8047be6ea51eb370d30da0a9ed8a7981a6dff854117248be2f84295f915bba210f3f7e70cecd59697d05f4ebc166b4d8c7e97989cb134b11df8ccd57ef7b4328503681ffbf89b968ded2296fe892f17f105d377367d0bdb4cea27cf8809cf9d25a2f9b515a5a825d6a5f5bab2c7c1469290ee6d6ec7c11e691af6f82bdd3eef5a597c156a33547865e6c2acfdebc80b39e9a2ac189711554eb1a3414f6db4dad7a0e8d2ae398fe56b55b9a91d7460872d3d32eed958f15a77cbfcc3276dc93326aac6b7d1dbc2b87e4c7c907db4f2f59e30ce267bd1fdbf4e5fb9e8955fc1479a096e3453eadf043ad5bd8279f2a5dcf9e73e0b31bf66ef2e4ee785821765b841b92b0b0347958e171f1a5f6d11f0b2cd2a6be14d31bb083e0a47b8cafaab44c89cc32a047a5fa6b9d3db92a85d15fd1dfad6330e45283a7220494af630ca815b4e0fa7b1bb29229dca860f70590d633e725ecce8ef1d1d18f4f479e2f1098f941759e6ee867a51dc33824edd269e893e974e9b7064100437375e9d74119fe6ca65a4d0b1dd7e189038bc5b64ca2b7f3efbfb17e6cc9d3851423c2dc7fb4d3b547e17e1494c3fdfb7b7cf56fc25cd4d832cf8670113723e777fa7a7e73ae619c244c534dab3250ffaf6dfdd8f821c98f6d85702ccea2ba38b6d5bcfb66f7821852156e2db977012c60e2fb4c941bbdb8380c02a933c6542fa7db351aa6978982abbbbb5b9217a750ee3939afe9dbf73fda8670b23c14fd1fdf5b1e08812f2d199bcfaf843970d66d7f63d45dcace60f6364624ebd6beac7f14493a3e6080625ce3f19b126fab7879f55edeebe593ab73043cd8b76794bc10d57efaf7d7a4e6d6bead1fcdbdf0c3043496af635c350893e1650c22e13f65f2f6fc17513bd8ada6f6d6bad7a5af15ca972c538cc2635c6917be5b4b4512ca70803eaddfc30ade911be13beee96ab8853b39f5ddebf36eb7d4c9867333d93ffd3f6234bc27d2241eff45171fb51cdf51a53af5c5e3373bb82ed6bba248bb09754add6197045b26cd76acffb6d855908a765f6e9e6ff041855c7835dd7fb3fcf8e0402862a5ef6ae57572bab636518095d8bcab16c6a8d8f829561eb965dfb211557ead8ace368538dc07a456c6e7182f85b017f6273cbfd3ed5e2910748e29d62115965af6185092db3a56fcf54fa6d85b1c13db5b7ffa258bca41fb3ab7ea917821ad6c7d58beb589fc1f5f2d57e1356b0a3fffcffcea7feb17bb9ebd895747febd2097c46099f1c5e086e5cbe58ecc78893f56260a92618dfff6adbc2d8f092e9d12122f456e4ec977c46804cee32bebec628ec954295838d24a180be14506665eec27fb35fd5ebabd7fabd72cd8cb5cb55ac2b8439b55fe9b2c9ff56c4e7a33e18405fe52aefde2361c4aa00a16a322c62fa9178b777abab623208fabf85c1172e5b0c28e0c5f6bfaaddfd92acb84f0a4f2f7f9fb621fe9a3e1efabfd12bc2eb58c51bff57456c34a777fa6fe9db8"
var MAVLinkData = "0a492a2d2a437e0000013f000001a6d496d67459eac85a19f160080045000031361240004011ee270a4001020a40010138cc38d6001d399bfd09000000010100000000000600020c000302da35b2787eafbe448c3ad806a51869dfd15bfc38286b89109a4b3252031e2b6d7035"

// const ivSize = zuc.IVSize128

func InforTxt(FileName string, infor string) {
	testRetFile, err := os.OpenFile(FileName, os.O_CREATE|os.O_APPEND|os.O_RDWR, 0666)
	if err != nil {
		log.Println(err)
	}
	_, err = fmt.Fprintln(testRetFile, infor)
	if err != nil {
		log.Println(err)
	}
}

/*func TestSm4CTR() {
	key, _ := hex.DecodeString("6368616e676520746869732070617373")
	// plaintext := []byte("some plaintext")
	plaintext := []byte(LongData)

	block, err := sm4.NewCipher(key)
	if err != nil {
		panic(err)
	}
	// fmt.Println("明文长度：", len(plaintext))
	ciphertext := make([]byte, len(plaintext))
	// iv := ciphertext[:sm4.BlockSize]
	iv := make([]byte, sm4.BlockSize)

	stream := cipher.NewCTR(block, iv)
	start := time.Now() // 获取当前时间
	stream.XORKeyStream(ciphertext, plaintext)
	elapsed := time.Since(start)
    fmt.Println("加密耗时：", elapsed)

	plaintext2 := make([]byte, len(plaintext))
	stream = cipher.NewCTR(block, iv)
	start = time.Now() // 获取当前时间
	stream.XORKeyStream(plaintext2, ciphertext)
	elapsed = time.Since(start)
	fmt.Println("解密耗时：", elapsed)
	// fmt.Printf("%s\n", plaintext2)
}*/

/*func TestAES() {
	key, _ := hex.DecodeString("6368616e676520746869732070617373")
	// plaintext := []byte("some plaintext")
	plaintext := []byte(LongData)

	blkCipher, err := aes.NewCipher([]byte(key))
	if err != nil {
		panic(err)
	}
	iv := make([]byte, blkCipher.BlockSize())
	// fmt.Println("明文长度：", len(plaintext))
	ciphertext := make([]byte, len(plaintext))
	// iv := ciphertext[:sm4.BlockSize]
	start := time.Now()
	cipher.NewCBCEncrypter(blkCipher, iv).CryptBlocks(ciphertext, plaintext)
	elapsed := time.Since(start)
    fmt.Println("加密耗时：", elapsed)

	plaintext2 := make([]byte, len(plaintext))
	start = time.Now()
	cipher.NewCBCDecrypter(blkCipher, iv).CryptBlocks(plaintext2, ciphertext)
	elapsed = time.Since(start)
	fmt.Println("解密耗时：", elapsed)
}*/

func MAVLinkTime() {
	key, _ := hex.DecodeString("6368616e676520746869732070617373")
	// plaintext := []byte("some plaintext")
	plaintext := []byte(MAVLinkData)

	block, err := sm4.NewCipher(key)
	if err != nil {
		panic(err)
	}
	// fmt.Println("明文长度：", len(plaintext))
	ciphertext := make([]byte, len(plaintext))
	// iv := ciphertext[:sm4.BlockSize]
	iv := make([]byte, sm4.BlockSize)

	stream := cipher.NewCTR(block, iv)
	start := time.Now() // 获取当前时间
	for i := 0; i < 10000; i++ {
		stream.XORKeyStream(ciphertext, plaintext)
	}
	// 加密耗时
	elapsed1 := time.Since(start)

	Mt1str := elapsed1.String()[0:6]
	Mt1float, _ := strconv.ParseFloat(Mt1str, 64)
	NewMt1str := strconv.FormatFloat(Mt1float*1000/10000, 'f', -1, 64)
	// DNewMt1str := fmt.Sprintf("%.2f", NewMt1str)
	// InforTxt("TimeCost.txt", Mt1str)    // 单位 毫秒
	fmt.Println(elapsed1)
	InforTxt("TimeCost.txt", NewMt1str) // 单位 微秒

	plaintext2 := make([]byte, len(plaintext))
	stream = cipher.NewCTR(block, iv)
	start = time.Now() // 获取当前时间
	for i := 0; i < 10000; i++ {
		stream.XORKeyStream(plaintext2, ciphertext)
	}
	// 解密耗时
	elapsed2 := time.Since(start)

	Mt2str := elapsed2.String()[0:6]
	Mt2float, _ := strconv.ParseFloat(Mt2str, 64)
	NewMt2str := strconv.FormatFloat(Mt2float*1000/10000, 'f', -1, 64)
	// DNewMt2str := fmt.Sprintf("%.2f", NewMt2str)
	// InforTxt("TimeCost.txt", Mt2str)    // 单位 毫秒
	fmt.Println(elapsed2)
	InforTxt("TimeCost.txt", NewMt2str) // 单位 微秒
}

func VideoTime() {
	key, _ := hex.DecodeString("6368616e676520746869732070617373")
	// plaintext := []byte("some plaintext")
	plaintext := []byte(VideoData)

	block, err := sm4.NewCipher(key)
	if err != nil {
		panic(err)
	}
	// fmt.Println("明文长度：", len(plaintext))
	ciphertext := make([]byte, len(plaintext))
	// iv := ciphertext[:sm4.BlockSize]
	iv := make([]byte, sm4.BlockSize)

	stream := cipher.NewCTR(block, iv)
	start := time.Now() // 获取当前时间
	for i := 0; i < 10000; i++ {
		stream.XORKeyStream(ciphertext, plaintext)
	}
	// 加密耗时
	elapsed1 := time.Since(start)

	Mt1str := elapsed1.String()[0:6]
	Mt1float, _ := strconv.ParseFloat(Mt1str, 64)
	NewMt1str := strconv.FormatFloat(Mt1float*1000/10000, 'f', -1, 64)
	// DNewMt1str := fmt.Sprintf("%.2f", NewMt1str)
	// InforTxt("TimeCost.txt", Mt1str)    // 单位 毫秒
	fmt.Println(elapsed1)
	InforTxt("TimeCost.txt", NewMt1str) // 单位 微秒

	plaintext2 := make([]byte, len(plaintext))
	stream = cipher.NewCTR(block, iv)
	start = time.Now() // 获取当前时间
	for i := 0; i < 10000; i++ {
		stream.XORKeyStream(plaintext2, ciphertext)
	}
	// 解密耗时
	elapsed2 := time.Since(start)

	Mt2str := elapsed2.String()[0:6]
	Mt2float, _ := strconv.ParseFloat(Mt2str, 64)
	NewMt2str := strconv.FormatFloat(Mt2float*1000/10000, 'f', -1, 64)
	// DNewMt2str := fmt.Sprintf("%.2f", NewMt2str)
	// InforTxt("TimeCost.txt", Mt2str)    // 单位 毫秒
	fmt.Println(elapsed2)
	InforTxt("TimeCost.txt", NewMt2str) // 单位 微秒
}

func main() {
	// TestSm4CTR()
	// TestAES()
	MAVLinkTime()
	VideoTime()
}

